/* @created: Wed Dec 11 10:13:15 UTC+0800 2013*/
_$JSDK3Loader$_&&_$JSDK3Loader$_.loadResource({
manifest : {
"name" : "ui-home","file" : "ui-home.js","version" : "1.0","description" : "","author" : "liu denggao","created" : "2013-12-09","modified" : "2013-12-09"
},
entity : {
"lib/classes/ui-home.json" : /* @created: Fri Dec 6 09:56:04 UTC+0800 2013*/
{
manifest : {
"name" : "ui-home","file" : "ui-home.json","version" : "1.0","description" : "","author" : "liu denggao","created" : "2013-12-06","modified" : "2013-12-06"
},
entity : {
"js.ui.PopupDialog" : "$package(\"js.ui\");$import(\"js.dom.HTML\");$import(\"js.dom.DOMTemplate\");js.ui.PopupDialog=function(){}\nvar _$class=js.ui.PopupDialog;with(_$class){$name=\"PopupDialog\";$extends(\"Object\");_$class._styleLib={\"std\":function(){var path=Engine.runtimeEnvironment.getResPath(\"js.ui\")+\"/PopupDialog\";if(!Browser.Engine.trident){return path+\"/std.css\";}else if(Browser.Engine.version<=3){return path+\"/std.IE6.css\";}else if(document.compatMode==\"CSS1Compat\"){return path+\"/std.css\";}else{return path+\"/std.IE.css\";}}()}\n_$class._styleSkin=\"\";_$class._defaultStyleSkin=\"std\";_$class._styleElement=null;_$class._isApped=false;_$class._isHidden=true;_$class._isAutoHide=true;_$class._htmlElement=null;_$class._outerElement=null;_$class._overlayElement=null;_$class._bodyStyleElement=null;_$class._callBack=null;_$class.returnValue;_$class.DISPLAY_MODE_CONTEXT=0;_$class.DISPLAY_MODE_DROPDOWN=1;_$class.DISPLAY_MODE_POSITION=2;_$class.DISPLAY_ALIGN_LEFT=0;_$class.DISPLAY_ALIGN_CENTER=1;_$class.DISPLAY_ALIGN_RIGHT=2;_$class.DISPLAY_ALIGN_UP=3;_$class.DISPLAY_ALIGN_MIDDLE=4;_$class.DISPLAY_ALIGN_BOTTOM=5;addProperty(true,true,\"htmlElement\",{get:function(){return this._htmlElement;}});addProperty(true,true,\"isHidden\",{get:function(){return this._isHidden;}});addMethod(true,true,\"show\",function(sURL,vArguments,oOptions,oFeatures,fnCallBack){if(!this._isHidden)this.hide();this._isHidden=false;var _this=this;var _owner=oOptions.owner;var _owner_htmElem=_owner.nodeName?_owner:(_owner.getHtmlElement?_owner.getHtmlElement():null);var _win_width=document.compatMode!=\"CSS1Compat\"?document.body.clientWidth:document.documentElement.clientWidth;var _win_height=document.compatMode!=\"CSS1Compat\"?document.body.clientHeight:document.documentElement.clientHeight;var _win_left=document.compatMode!=\"CSS1Compat\"?document.body.scrollLeft:!Global.Browser.Engine.webkit?document.documentElement.scrollLeft:document.body.scrollLeft;var _win_top=document.compatMode!=\"CSS1Compat\"?document.body.scrollTop:!Global.Browser.Engine.webkit?document.documentElement.scrollTop:document.body.scrollTop;var _event=oOptions.event;var _driver=oOptions.driver||\"html\";var _mode=oOptions.mode!=undefined?oOptions.mode:(_owner?1:0);var _autoHide=this._isAutoHide=_mode!=2||oOptions.autoHide==undefined||oOptions.autoHide;var _minWidth=oFeatures.minWidth||100;var _minHeight=oFeatures.minHeight||50;var _width=oFeatures.width||_minWidth;var _height=oFeatures.height||_minHeight;var _align=oFeatures.align!=undefined?oFeatures.align:this.DISPLAY_ALIGN_CENTER;var _left=oFeatures.left!=undefined?oFeatures.left:(_mode==2?-1:0);var _top=oFeatures.top!=undefined?oFeatures.top:(_mode==2?-1:0);var _right=oFeatures.right!=undefined?oFeatures.right:(_mode==2?-1:0);var _bottom=oFeatures.bottom!=undefined?oFeatures.bottom:(_mode==2?-1:0);var _emptyHtml=\"<div class=\\\"empty\\\">no data</div>\";this._htmlElement=document.body.appendChild(document.createElement(\"div\"));this._callBack=fnCallBack;if(!this._styleSkin)this.setStyleSkin(this._defaultStyleSkin);if(oFeatures.style)this.setBodyStyle(oFeatures.style);switch(_mode){case 0:_left=_event.pageX||(_event.clientX+document.body.scrollLeft-document.body.clientLeft);_top=_event.pageY||(_event.clientY+document.body.scrollTop-document.body.clientTop);break;case 1:var _owner_left=HTML.getLeftOnDoc(_owner_htmElem);var _owner_top=HTML.getTopOnDoc(_owner_htmElem);var _owner_width=_owner_htmElem.offsetWidth;var _owner_height=_owner_htmElem.offsetHeight;var _owner_leftWidth=_owner_left-_win_left+1;var _owner_rightWidth=(_win_left+_win_width-1)-(_owner_left+_owner_width-1)+1;var _owner_topHeight=_owner_top-_win_top+1;var _owner_bottomHeight=(_win_top+_win_height-1)-(_owner_top+_owner_height-1)+1;_width=Math.max(_minWidth,oFeatures.width||_owner_htmElem.offsetWidth);if(_width>_win_width){_left=_win_left;}else if(_width<=_owner_width+_owner_rightWidth){_left=_owner_left;}else if(_width<=_owner_width+_owner_leftWidth){_left=_owner_left+_owner_width-1-_width;}else{_left=_win_left+_win_width-_width;}\nif(_height>_win_height){_top=_win_top;}else if(_height<=_owner_bottomHeight){_top=_owner_top+_owner_height;}else if(_height<=_owner_topHeight){_top=_owner_top-_height;}else{_top=_win_top+_win_height-_height;}\nbreak;case 2:this._overlayElement=this._htmlElement;this._outerElement=document.body.appendChild(document.createElement(\"div\"));this._htmlElement=this._outerElement.appendChild(document.createElement(\"div\"));with(this._overlayElement){className=\"PopupDialogOverlay\";setAttribute(\"class\",\"PopupDialogOverlay\");if(Global.Browser.Engine.trident&&Global.Browser.Engine.version==3){innerHTML=\"<iframe frameborder=0 scrolling=no src=\\\"about:blank\\\"\"\n+\" style=\\\"width:100%;height:100%;z-index:-1;left:0;top:0;position:absolute;\\\"\"\n+\" onload=\\\"this.contentWindow.document.body.style.backgroundColor=\"\n+\" this.parentNode.currentStyle.backgroundColor!='transparent'?\"\n+\" this.parentNode.currentStyle.backgroundColor:this.parentNode.firstChild.currentStyle.backgroundColor;\\\"></iframe>\";}}\nwith(this._outerElement){className=\"PopupDialogOuter\";setAttribute(\"class\",\"PopupDialogOuter\");}\nif(_left!=-1&&_right!=-1){_left=-1;}\nif(_top!=-1&&_bottom!=-1){_top=-1;}\nif((_left!=-1||_right!=-1)&&(_top!=-1||_bottom!=-1)){}else if(_left!=-1||_right!=-1){switch(_align){case 3:_top=0;break;case 4:_top=Math.foolr((_win_height-_height)/2);break;case 5:_bottom=0;break;default:_top=Math.floor((_win_height-_height)/2);break;}}else if(_top!=-1||_bottom!=-1){switch(_align){case 0:_left=0;break;case 1:_left=Math.floor((_win_width-_width)/2);break;case 2:_right=0;break;}}else{switch(_align){case 0:_left=0;_top=Math.floor((_win_height-_height)/2);break;case 1:_left=Math.floor((_win_width-_width)/2);_top=Math.floor((_win_height-_height)/2);break;case 2:_right=0;_top=Math.floor((_win_height-_height)/2);break;case 3:_left=Math.floor((_win_width-_width)/2);_top=0;break;case 4:_left=Math.floor((_win_width-_width)/2);_top=Math.floor((_win_height-_height)/2);break;case 5:_left=Math.floor((_win_width-_width)/2);_bottom=0;break;}}\nbreak;}\nwith(this._htmlElement){className=\"PopupDialog\";setAttribute(\"class\",\"PopupDialog\");onclick=function(event){event=event||window.event;event.cancelBubble=true;}}\nif(_left!=-1)this._htmlElement.style.left=_left+\"px\";if(_top!=-1)this._htmlElement.style.top=_top+\"px\";if(_right!=-1)this._htmlElement.style.right=_right+\"px\";if(_bottom!=-1)this._htmlElement.style.bottom=_bottom+\"px\";this._htmlElement.style.width=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?_width:(_width-2))+\"px\";this._htmlElement.style.height=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?_height:(_height-2))+\"px\";this._htmlElement.style.zIndex=100;switch(_driver){case\"html\":if(typeof(sURL)!=\"string\"){this._htmlElement.innerHTML=_emptyHtml;}else if(sURL.charAt(0)==\"#\"){var el=Global.dom(sURL).pop();this._htmlElement.innerHTML=el?(el.value||el.text||_emptyHtml):_emptyHtml;}else{this._htmlElement.innerHTML=sURL;}\nbreak;case\"page\":if(typeof(sURL)!=\"string\"){this._htmlElement.innerHTML=_emptyHtml;}else if(sURL.charAt(0)==\"#\"){this._htmlElement.innerHTML=_emptyHtml;}else{with(this._htmlElement){innerHTML=\"<iframe frameborder=0 style=\\\"width:100%;height:100%;\\\" src=\\\"\"+sURL+\"\\\"></iframe>\";}}\nbreak;case\"template\":var tpl,json;if(sURL instanceof Global.DOMTemplate){tpl=sURL;}else if(typeof(sURL)!=\"string\"){}else if(sURL.charAt(0)==\"#\"){tpl=Global.DOMTemplate.newInstanceWithId(sURL.slice(1));}else{tpl=Global.DOMTemplate.newInstanceWithUrl(sURL);}\nswitch(typeof(vArguments)){case\"string\":if(vArguments.slice(0,9)==\"url(xml):\"){json=Global.xml2json(Global.get(vArguments.slice(0,9),\"\",false,\"\",\"XML\"));}else if(vArguments.slice(0,10)==\"url(json):\"){json=Global.get(vArguments.slice(0,10),\"\",false,\"\",\"JSON\");}else{json={};}\nbreak;case\"object\":json=vArguments;break;}\nif(tpl&&json){this._htmlElement.innerHTML=tpl.parse(json,null);if(json.init)json.init(this,this._htmlElement);}else{this._htmlElement.innerHTML=_emptyHtml;}\nbreak;}\nif(Browser.Engine.trident&&Browser.Engine.version==3){this._htmlElement.appendChild(document.createElement(\"<iframe frameborder=0 scrolling=no src=\\\"about:blank\\\"\"\n+\" style=\\\"width:100%;height:100%;z-index:-1;left:0;top:0;position:absolute;\\\"\"\n+\" onload=\\\"this.contentWindow.document.body.style.backgroundColor=\"\n+\" this.parentNode.currentStyle.backgroundColor!='transparent'?\"\n+\" this.parentNode.currentStyle.backgroundColor:this.parentNode.firstChild.currentStyle.backgroundColor;\\\"></iframe>\"));}\nif(_event){_event.cancelBubble=true;_event.returnValue=_event.result={activeApp:_this}}\nif(!this._isApped){document.body.attachEvent(\"onclick\",function(event){event=event||window.event;var data=event.result||event.returnValue;if(typeof(data)==\"object\"&&data.activeApp==_this){return;}else if(!_this._isHidden&&_this._isAutoHide){if(data)data.activeApp=null;_this.hide();}});this._isApped=true;}});addMethod(true,true,\"hide\",function(){if(this._isHidden)return;if(this._htmlElement)this._htmlElement.parentNode.removeChild(this._htmlElement);if(this._outerElement)this._outerElement.parentNode.removeChild(this._outerElement);if(this._overlayElement)this._overlayElement.parentNode.removeChild(this._overlayElement);if(this._bodyStyleElement)this._bodyStyleElement.parentNode.removeChild(this._bodyStyleElement);if(this._callBack)this._callBack(this.returnValue);this._isHidden=true;this._htmlElement=null;this._outerElement=null;this._bodyStyleElement=null;this._callBack=null;this.returnValue=undefined;});addMethod(true,true,\"addStyleSkin\",function(sName,sPath){this._styleLib[sName]=sPath;});addMethod(true,true,\"setStyleSkin\",function(sName){this._styleSkin=sName;if(!this._styleElement){var style=this._styleElement=document.createElement(\"link\");style.type=\"text/css\";style.rel=\"stylesheet\";style.href=this._styleLib[sName];document.getElementsByTagName(\"HEAD\")[0].appendChild(style);}else{this._styleElement.style.href=this._styleLib[sName];}});addMethod(true,true,\"setBodyStyle\",function(sPath){var _this=this;var style=this._bodyStyleElement=document.createElement(\"link\");style.type=\"text/css\";style.rel=\"stylesheet\";style.href=sPath;style.onload=function(){_this._htmlElement.style.zoom=1;}\ndocument.getElementsByTagName(\"HEAD\")[0].appendChild(style);});}",
"js.ui.WebReminderDialogBox" : "$package(\"js.ui\");$import(\"js.dom.HTML\");$import(\"js.dom.DOMTemplate\");js.ui.WebReminderDialogBox=function(sURL,vArguments,oOptions,oFeatures,fnCallBack){this._id=\"\";this._left=0;this._top=0;this._minWidth=100;this._minHeight=50;this._width=0;this._height=0;this._indexInSames=0;this._driver=\"\";this._mode=0;this._htmlElement=null;this._stylePath=\"\";this._styleElement=null;this._callBack;this.returnValue;this.__timer;this.__startEffect;this.__stayInterval=0;this.__stayEffect;this.__exitEffect;this._WebReminderDialogBox(sURL,vArguments,oOptions,oFeatures,fnCallBack);}\nvar _$class=js.ui.WebReminderDialogBox;with(_$class){$name=\"WebReminderDialogBox\";$extends(\"Object\");_$class._styleLib={\"std\":Engine.runtimeEnvironment.getResPath(\"js.ui\")+\"/WebReminderDialogBox/\"+(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?\"std.IE.css\":\"std.css\")}\n_$class._styleSkin=\"std\";_$class._styleElement=null;_$class._appStyleElement=null;_$class._apps=[];_$class._isApped=false;_$class.__usedIdCount=0;addMethod(false,false,\"WebReminderDialogBox\",function(sURL,vArguments,oOptions,oFeatures,fnCallBack){var _emptyHtml=\"<div class=\\\"empty\\\">no data</div>\";this._id=\"DBX\"+(++this.getClass().__usedIdCount);this._driver=oOptions.driver||\"html\";this._mode=oOptions.mode!=undefined?oOptions.mode:0;this._width=oFeatures.width||this._minWidth;this._height=oFeatures.height||this._minHeight;this._left=oFeatures.left||0;this._top=oFeatures.top||0;this._stylePath=oFeatures.style||\"\";this._htmlElement=document.body.appendChild(document.createElement(\"div\"));this._callBack=fnCallBack;this.__startEffect=oOptions.startEffect;this.__stayInterval=oOptions.stayInterval||0;this.__stayEffect={};this.__exitEffect=oOptions.exitEffect;this._setStyleSkin(this._stylePath);for(var i=0,objs=this.getClass()._apps;i<objs.length;i++){var obj=objs[i];if(obj==this){break;}else if(obj.__startEffect.enabled&&obj.__startEffect.from==this.__startEffect.from){this._indexInSames++;}}\nwith(this._htmlElement){className=\"WebDialogBox\";setAttribute(\"class\",\"WebDialogBox\");onclick=function(event){event=event||window.event;event.cancelBubble=true;}}\nif(this.__startEffect&&this.__startEffect.enabled){this._htmlElement.style.display=\"none\";}\nthis._htmlElement.style.left=this._left+\"px\";this._htmlElement.style.top=this._top+\"px\";this._htmlElement.style.width=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?this._width:(this._width-2))+\"px\";this._htmlElement.style.height=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?this._height:(this._height-2))+\"px\";switch(this._driver){case\"html\":if(typeof(sURL)!=\"string\"){this._htmlElement.innerHTML=_emptyHtml;}else if(sURL.charAt(0)==\"#\"){var el=Global.dom(sURL).pop();this._htmlElement.innerHTML=el?(el.value||el.text||_emptyHtml):_emptyHtml;}else{this._htmlElement.innerHTML=sURL;}\nbreak;case\"page\":if(typeof(sURL)!=\"string\"){this._htmlElement.innerHTML=_emptyHtml;}else if(sURL.charAt(0)==\"#\"){this._htmlElement.innerHTML=_emptyHtml;}else{with(this._htmlElement){innerHTML=\"<iframe frameborder=0 style=\\\"width:100%;height:100%;\\\" src=\\\"\"+sURL+\"\\\"></iframe>\";}}\nbreak;case\"template\":var tpl,json;if(sURL instanceof Global.DOMTemplate){tpl=sURL;}else if(typeof(sURL)!=\"string\"){}else if(sURL.charAt(0)==\"#\"){tpl=Global.DOMTemplate.newInstanceWithId(sURL.slice(1));}else{tpl=Global.DOMTemplate.newInstanceWithUrl(sURL);}\nswitch(typeof(vArguments)){case\"string\":if(vArguments.slice(0,9)==\"url(xml):\"){json=Global.xml2json(Global.get(vArguments.slice(0,9),\"\",false,\"\",\"XML\"));}else if(vArguments.slice(0,10)==\"url(json):\"){json=Global.get(vArguments.slice(0,10),\"\",false,\"\",\"JSON\");}else{json={};}\nbreak;case\"object\":json=vArguments;break;}\nif(tpl&&json){this._htmlElement.innerHTML=tpl.parse(json);if(json.init)json.init(this,this._htmlElement);}else{this._htmlElement.innerHTML=_emptyHtml;}\nbreak;}\nif(this.__startEffect&&this.__startEffect.enabled){this._playStartingEffect();}\nthis.getClass().fireEvent(\"_onDialogOpened\",this);});addProperty(false,true,\"width\",{get:function(){return this._width;}});addProperty(false,true,\"height\",{get:function(){return this._height;}});addProperty(false,true,\"mode\",{get:function(){return this._mode;}});addMethod(true,true,\"show\",function(sURL,vArguments,oOptions,oFeatures,fnCallBack){new this(sURL,vArguments,oOptions,oFeatures,fnCallBack);});addMethod(true,true,\"addStyleSkin\",function(sName,sPath){this._styleLib[sName]=sPath;});addMethod(true,true,\"setStyleSkin\",function(sName){this._styleSkin=sName;if(!this._styleElement){var style=this._styleElement=document.createElement(\"link\");style.type=\"text/css\";style.rel=\"stylesheet\";style.href=this._styleLib[sName];document.getElementsByTagName(\"HEAD\")[0].appendChild(style);}else{this._styleElement.style.href=this._styleLib[sName];}});addMethod(true,false,\"addAppStyleContainer\",function(){var style=this._appStyleElement=document.createElement(\"style\");style.type=\"text/css\";document.getElementsByTagName(\"HEAD\")[0].appendChild(style);});addMethod(false,false,\"setStyleSkin\",function(sPath){if(!this._styleElement){var style=this._styleElement=document.createElement(\"link\");style.type=\"text/css\";style.rel=\"stylesheet\";style.href=sPath;document.getElementsByTagName(\"HEAD\")[0].appendChild(style);}else{this._styleElement.style.href=sPath;}});addMethod(false,true,\"close\",function(){this.fireEvent(\"_onBeforeClose\");});addMethod(false,false,\"playStartingEffect\",function(){var _this=this;var _clientWidth=document.compatMode!=\"CSS1Compat\"?document.body.clientWidth:document.documentElement.clientWidth;var _clientHeight=document.compatMode!=\"CSS1Compat\"?document.body.clientHeight:document.documentElement.clientHeight;var _scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var _scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this.__startEffect&&this.__startEffect.enabled){this._htmlElement.style.display=\"\";switch(this.__startEffect.from){case\"left\":this._htmlElement.style.left=-this._width+document.body.scrollLeft;break;case\"top\":this._htmlElement.style.top=-this._height+document.body.scrollTop;break;case\"right\":this._htmlElement.style.left=document.body.clientWidth+document.body.scrollLeft;break;case\"left,bottom\":this._htmlElement.style.top=document.body.clientHeight+document.body.scrollTop;break;case\"right,bottom\":this._htmlElement.style.left=_clientWidth+_scrollLeft-this._width+\"px\";this._htmlElement.style.top=_clientHeight+_scrollTop-this._indexInSames*this._height+\"px\";break;}\nthis.__startEffect.remainSteps=Math.ceil((this._indexInSames+1)*this._height/this.__startEffect.step);this.__startEffect.proc=function(){try{switch(_this.__startEffect.from){case\"right,bottom\":_this._htmlElement.style.top=Math.max(parseInt(_this._htmlElement.style.top)-_this.__startEffect.step,_clientHeight+_scrollTop-(_this._indexInSames+1)*_this._height)+\"px\";if(--_this.__startEffect.remainSteps<=0){clearInterval(_this._timer);_this._playStayingEffect();}\nbreak;}}catch(e){clearInterval(_this._timer);}}}\nthis._timer=setInterval(this.__startEffect.proc,this.__startEffect.speed);});addMethod(false,false,\"playStayingEffect\",function(){if(!this.__stayInterval)return;var _this=this;var _clientWidth=document.compatMode!=\"CSS1Compat\"?document.body.clientWidth:document.documentElement.clientWidth;var _clientHeight=document.compatMode!=\"CSS1Compat\"?document.body.clientHeight:document.documentElement.clientHeight;this.__stayEffect.speed=10;this.__stayEffect.step=10;this.__stayEffect.remainSteps=Math.ceil(this.__stayInterval/this.__stayEffect.step);this.__stayEffect.proc=function(){try{var _scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var _scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);switch(_this.__startEffect.from){case\"right,bottom\":_this._htmlElement.style.left=_clientWidth+_scrollLeft-_this._width+\"px\";_this._htmlElement.style.top=_clientHeight+_scrollTop-(_this._indexInSames+1)*_this._height+\"px\";break;}\nif(_this.__exitEffect&&_this.__exitEffect.enabled\n&&--_this.__stayEffect.remainSteps<=0){clearInterval(_this._timer);_this._playExitingEffect();}}catch(e){clearInterval(_this._timer);}}\nthis._timer=setInterval(this.__stayEffect.proc,this.__stayEffect.speed);});addMethod(false,false,\"playExitingEffect\",function(){if(!this.__exitEffect||!this.__exitEffect.enabled)return;var _this=this;var _clientWidth=document.compatMode!=\"CSS1Compat\"?document.body.clientWidth:document.documentElement.clientWidth;var _clientHeight=document.compatMode!=\"CSS1Compat\"?document.body.clientHeight:document.documentElement.clientHeight;var _scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft);var _scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);clearInterval(this._timer);this.__exitEffect.remainSteps=Math.ceil((this._indexInSames+1)*this._height/this.__exitEffect.step);this.__exitEffect.proc=function(){try{switch(_this.__exitEffect.to){case\"right,bottom\":_this._htmlElement.style.top=Math.min(parseInt(_this._htmlElement.style.top)+_this.__exitEffect.step,_clientHeight+_scrollTop)+\"px\";if(--_this.__exitEffect.remainSteps<=0){clearInterval(_this._timer);_this.fireEvent(\"_onClose\");}\nbreak;}}catch(e){clearInterval(_this._timer);}}\nthis._timer=setInterval(this.__exitEffect.proc,this.__exitEffect.speed);});addMethod(true,true,\"fireEvent\",function(sEvent,oEventObject){if(typeof(this[sEvent])!=\"function\")return;try{return this[sEvent](oEventObject);}catch(e){throw new Error(1000,\"Event '\"+sEvent+\"' of object '\"+this.getName()+\"' has been runned error!\\nSource: \"\n+e.description);}});addEventListener(true,false,\"onDialogOpened\",function(oDialog){this._apps[this._apps.length]=oDialog;});addEventListener(true,false,\"onDialogClosed\",function(oDialog){this._apps.removeElement(this._apps.findElement(oDialog));});addEventListener(false,false,\"onBeforeClose\",function(){if(this.__exitEffect&&this.__exitEffect.enabled){this._playExitingEffect();}else{this.fireEvent(\"_onClose\");}});addEventListener(false,false,\"onClose\",function(){clearInterval(this._timer);if(this._htmlElement)this._htmlElement.parentNode.removeChild(this._htmlElement);if(this._styleElement)this._styleElement.parentNode.removeChild(this._styleElement);this._htmlElement=null;this._styleElement=null;this.getClass().fireEvent(\"_onDialogClosed\",this);if(this._callBack)this._callBack(this.returnValue);this._callBack=null;});}",
"js.ui.menu.PopupMenuLite" : "$package(\"js.ui.menu\");$import(\"js.dom.HTML\");js.ui.menu.PopupMenuLite=function(owner,mode,options){this._id=\"\";this._owner=null;this._owner_htmElem=null;this._mode=0;this._mainMenu=null;this._activeMenu=null;this._isHideOnMouseLeave;this._offset=0;this._minWidth=0;this._padWidth=0;this._version=\"1.7.4 Final 20111109\";this.__usedIdCount=0;this._PopupMenuLite(owner,mode,options);}\nvar _$class=js.ui.menu.PopupMenuLite;var _$proto=_$class.prototype;with(_$class){$name=\"PopupMenuLite\";$extends(\"Object\");_$class._icons={checked:\"<span style=\\\"width:12px;height:12px;display:inline-block;overflow:hidden\\\"><span style=\\\"font-family:Marlett;font-size:16px;position:relative;top:-2;left:-1\\\">a</span></span>\",radioed:\"<span style=\\\"width:12px;height:12px;display:inline-block;overflow:hidden\\\"><span style=\\\"font-family:Marlett;font-size:9px;position:relative;top:2;\\\">n</span></span>\",arrow:\"<span style=\\\"width:12px;height:12px;display:inline-block;overflow:hidden\\\"><span style=\\\"font-family:'wingdings 3';font-size:12px;position:relative;top:;left:\\\">}</span></span>\",blank:\"<span style=\\\"width:12px;height:12px;display:inline-block;overflow:hidden\\\">&nbsp;</span>\"}\n_$class._styleLib={\"classic\":Engine.runtimeEnvironment.getResPath(\"js.ui.menu\")+\"/PopupMenuLite/\"+(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?\"Classic.IE.css\":\"Classic.css\"),\"xp\":Engine.runtimeEnvironment.getResPath(\"js.ui.menu\")+\"/PopupMenuLite/\"+(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?\"XP.IE.css\":\"XP.css\")}\n_$class._styleSkin=\"classic\";_$class._styleElement=null;_$class._activeAppMenu=null;_$class._isInstanced=false;prototype._PopupMenuLite=function(owner,mode,options){var thisObj=this;this._owner=owner;this._owner_htmElem=owner.nodeName?owner:(owner.getHtmlElement?owner.getHtmlElement():null);if(typeof(mode)!=\"undefined\")this._mode=mode;this._isHideOnMouseLeave=false;this._offset=options&&options.offset||0;if(options&&options.minWidth){this._minWidth=options.minWidth;}\nif(options&&options.padWidth){this._padWidth=options.padWidth;}\nthis.getClass().fireEvent(\"_onAppInstanced\",this);}\naddProperty(true,true,\"activeAppMenu\",{get:function(){return this._activeAppMenu;}});addProperty(false,true,\"owner\",{get:function(){return this._owner;}});addProperty(false,true,\"ownerHtmlElement\",{get:function(){return this._owner_htmElem;}});addProperty(false,true,\"mode\",{get:function(){return this._mode;},set:function(value){this._mode=value;}});addProperty(false,true,\"isHideOnMouseLeave\",{get:function(){return this._isHideOnMouseLeave;},set:function(value){this._isHideOnMouseLeave=value;}});addProperty(false,true,\"mainMenu\",{get:function(){return this._mainMain;}});addProperty(false,true,\"activeMenu\",{get:function(){return this._mainMenu;}});addProperty(false,true,\"version\",{get:function(){return this._version;}});addProperty(false,true,\"allCount\",{get:function(){if(!this._mainMenu)return 0;return this._mainMenu.getLength();}});addMethod(false,true,\"show\",function(event,iWidth,aCoordinate){if(this._mainMenu)this._mainMenu.show(event,iWidth,aCoordinate);});addMethod(false,true,\"hide\",function(){if(this._mainMenu)this._mainMenu.hide();});addMethod(false,true,\"addItem\",function(sTitle,vData,fnAction){var Menu=this.getClass().Menu;var Item=this.getClass().Item;if(!this._mainMenu){this._mainMenu=new Menu(this);}\nvar newItem=new Item(this._mainMenu,sTitle,vData,fnAction);this._mainMenu.addItem(newItem);return(newItem);});addMethod(false,true,\"getItem\",function(index){if(!this._mainMenu)return null;return this._mainMenu.getItem(index);});addMethod(false,true,\"getItemById\",function(id){if(!this._mainMenu)return null;return this._mainMenu.getItemById(id);});addMethod(true,true,\"addStyleSkin\",function(sName,sPath){this._styleLib[sName]=sPath;});addMethod(true,true,\"setStyleSkin\",function(sName){this._styleSkin=sName;if(!this._styleElement){var style=this._styleElement=document.createElement(\"link\");style.type=\"text/css\";style.rel=\"stylesheet\";style.href=this._styleLib[sName];document.getElementsByTagName(\"HEAD\")[0].appendChild(style);}else{this._styleElement.style.href=this._styleLib[sName];}});addMethod(true,true,\"fireEvent\",function(sEvent,oEventObject){if(typeof(this[sEvent])!=\"function\")return;try{return this[sEvent](oEventObject);}catch(e){throw new Error(1000,\"Event '\"+sEvent+\"' of object '\"+this.getName()+\"' has been runned error!\\nSource: \"\n+e.description);}});addEventListener(true,false,\"onFirstInstanced\",function(oAppMenu){var thisObj=this;if(Global.Browser.Platform.ios){document.body.attachEvent(\"ontouchmove\",function(event){thisObj.__isMoving=true;});document.body.attachEvent(\"ontouchend\",function(event){var data=event.result||event.returnValue;if(!thisObj.__isMoving){if(typeof(data)==\"object\"&&data.activeApp==thisObj){return;}else{thisObj.fireEvent(\"_onAppMenuBlur\");}}\nthisObj.__isMoving=false;});}else if(document.body.addEventListener){document.body.addEventListener(\"onclick\",function(event){event=event||window.event;var data=event.result||event.returnValue;if(typeof(data)==\"object\"&&data.activeApp==thisObj){return;}else{thisObj.fireEvent(\"_onAppMenuBlur\");}});}else{document.body.attachEvent(\"onclick\",function(event){event=event||window.event;var data=event.result||event.returnValue;if(typeof(data)==\"object\"&&data.activeApp==thisObj){return;}else{thisObj.fireEvent(\"_onAppMenuBlur\");}});}});addEventListener(true,false,\"onAppInstanced\",function(oAppMenu){if(this._isInstanced)return;this.fireEvent(\"_onFirstInstanced\",oAppMenu);});addEventListener(true,false,\"onAppMenuBeforeShow\",function(oAppMenu){if(this._activeAppMenu)this._activeAppMenu.hide();});addEventListener(true,false,\"onAppMenuShowed\",function(oAppMenu){this._activeAppMenu=oAppMenu;});addEventListener(true,false,\"onAppMenuHid\",function(oAppMenu){this._activeAppMenu=null;});addEventListener(true,false,\"onAppMenuBlur\",function(){var lastAppMenu=this._activeAppMenu;if(this._activeAppMenu)this._activeAppMenu.hide();this.fireEvent(\"onAppMenuBlur\",lastAppMenu);});addEventListener(false,false,\"onMenuBeforeShow\",function(oMenu){this.getClass().fireEvent(\"_onAppMenuBeforeShow\",this);});addEventListener(false,false,\"onMenuShowed\",function(oMenu){this.getClass().fireEvent(\"_onAppMenuShowed\",this);});addEventListener(false,false,\"onMenuHid\",function(oMenu){this.getClass().fireEvent(\"_onAppMenuHid\",this);});addEventListener(false,false,\"onDoAction\",function(oMenu){this.fireEvent(\"onDoAction\",oMenu.getLastDoneItem());});}\n_$class.Menu=function(owner){this._id=\"\";this._unid=\"\";this._owner=null;this._parentApp=null;this._htmlElement=null;this._htmlContainer=null;this._items=[];this._useIcon=false;this._loaded=false;this._activeItem=null;this._lastDoneItem=null;this._Menu(owner);}\nwith(_$class.Menu){$name=\"Menu\";$extends(Object);prototype._Menu=function(owner){this._owner=owner;this._parentApp=this._owner;}\nprototype.getLeft=function(){return this._x;}\nprototype.getTop=function(){return this._y;}\nprototype.getRight=function(){return this.getLeft()+this.getWidth()-1;}\nprototype.getBottom=function(){return this.getTop()+this.getHeight()-1;}\nprototype.getWidth=function(){return this._htmlElement.offsetWidth;}\nprototype.getHeight=function(){return this._htmlElement.offsetHeight;}\nprototype.getLength=function(){return this._items.length;}\nprototype.getParentApp=function(){return this._parentApp;}\nprototype.getOwner=function(){return this._owner;}\nprototype.getDisplayed=function(){if(!this._htmlElement)return false;return this._htmlElement.style.display==\"\";}\nprototype.getActiveItem=function(){return this._activeItem;}\nprototype.getLastDoneItem=function(){return this._lastDoneItem;}\nprototype.getIsActive=function(){if(this.getParentApp()._activeMenu==this)return true;else return false;}\nprototype.getUseIcon=function(){return this._useIcon;}\nprototype.addItem=function(newItem){this._items[this._items.length]=newItem;newItem._parentMenu=this;if(this._loaded){this.load(newItem);}\nreturn(newItem);}\nprototype.getItem=function(index){if(index<0||index>=this._items.length)return null;return this._items[index];}\nprototype.getItemById=function(id){for(var i=0;i<this._items.length;i++){var item=this.getItem(i);if(item.getId()==id)return(item);}\nreturn(null);}\nprototype.getItemByTitle=function(title){for(var i=0;i<this.getLength();i++){var item=this.getItem(i);if(item.getTitle()==title)return(item);}\nreturn(null);}\nprototype.getFirstItem=function(){return(this.getItem(0));}\nprototype.getNextItem=function(item){for(var i=0;i<this.getLength();i++){if(this.getItem(i).getId()==item.getId()){if(i==this.getLength()-1){return(null);}else{return(this.getItem(i+1));}}}\nthrow(\"\\u9519\\u8bef\\uff01\\\"PopupMenuLite.Menu.getNextItem(item)\\\"\\u8f93\\u5165\\u7684\\u83dc\\u5355\\u9879\\u4e0d\\u5728\\u672c\\u83dc\\u5355\\u4e2d\\u3002\");return(null);}\nprototype.getPrevItem=function(item){for(var i=0;i<this.getLength();i++){if(this.getItem(i).getId()==item.getId()){if(i==0){return(null);}else{return(this.getItem(i-1));}}}\nthrow(\"\\u9519\\u8bef\\uff01\\\"PopupMenuLite.Menu.getPrevItem(item)\\\"\\u8f93\\u5165\\u7684\\u83dc\\u5355\\u9879\\u4e0d\\u5728\\u672c\\u83dc\\u5355\\u4e2d\\u3002\");return(null);}\nprototype.getLastItem=function(){return(this.getItem(this.getLength()-1));}\nprototype.getAllItems=function(){return this._items;}\nprototype.show=function(event,iWidth,aCoordinate){var thisObj=this;var iLeft=0,iTop=0,iHeight=0;var aItems=this._getItemsToActualShow();this._lastDoneItem=null;event.returnValue=event.result={activeApp:this.getParentApp().getClass()}\nthis.fireEvent(\"_onBeforeShow\");if(this._items.length==0)return;if(!this._loaded)this._load();if(aCoordinate){iLeft=aCoordinate[0];iTop=aCoordinate[1];}else{switch(this.getParentApp().getMode()){case 0:iLeft=event.pageX||(event.clientX+document.body.scrollLeft-document.body.clientLeft);iTop=event.pageY||(event.clientY+document.body.scrollTop-document.body.clientTop);iWidth=Math.max(this._getMinWidth(aItems),iWidth||0);break;case 1:iLeft=HTML.getLeftOnDoc(this.getParentApp()._owner_htmElem);iTop=HTML.getBottomOnDoc(this.getParentApp()._owner_htmElem)+1;iWidth=Math.max(this._getMinWidth(aItems),iWidth||this.getParentApp()._owner_htmElem.offsetWidth);break;}\niLeft+=this._parentApp._offset;iWidth=Math.max(iWidth,this._parentApp._minWidth);iWidth+=this._parentApp._padWidth;}\niHeight=this._getMinHeight(aItems);this._htmlElement.style.left=iLeft+\"px\";this._htmlElement.style.top=iTop+\"px\";this._htmlElement.style.width=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?iWidth:(iWidth-2))+\"px\";this._htmlElement.style.height=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?iHeight:(iHeight-2))+\"px\";this._htmlElement.style.display=\"\";this._htmlContainer.style.width=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?(iWidth-2):(iWidth-6))+\"px\";this._htmlContainer.style.height=(Browser.Engine.trident&&document.compatMode!=\"CSS1Compat\"?(iHeight-2):(iHeight-6))+\"px\";this._showSepLine();this.fireEvent(\"_onShow\");}\nprototype._showSepLine=function(){for(var i=0,iLen=this._items.length-1;i<iLen;i++){if(this._items[i].getTitle()==\"-\"){this._items[i]._htmlElement.style.display=\"block\";}}\nfor(var i=Math.max(0,this._items.length-1);i<this._items.length;i++){if(this._items[i].getTitle()==\"-\"){this._items[i]._htmlElement.style.display=\"none\";}}}\nprototype.hide=function(){if(!this.getDisplayed())return;if(this._htmlElement)this._htmlElement.style.display=\"none\";this.fireEvent(\"_onHide\");}\naddMethod(false,true,\"getVisibleCount\",function(){var count=0;for(var i=0;i<this._items.length;i++){if(!this._items[i].getIsHidden()){count++;}}\nreturn count;});prototype._toHtmlElement=function(){var thisObj=this;if(this._htmlElement)return;this._htmlElement=document.body.appendChild(document.createElement(\"div\"));with(this._htmlElement){className=\"OutsideBox PopupMenu\";setAttribute(\"class\",\"OutsideBox PopupMenu\");with(this._htmlContainer=appendChild(document.createElement(\"div\"))){className=\"InsideBox PopupMenuContent\";setAttribute(\"class\",\"InsideBox PopupMenuContent\");id=\"content\";}\nif(Browser.Engine.trident&&Browser.Engine.version==3){appendChild(document.createElement(\"<iframe frameborder=0 scrolling=no src=\\\"about:blank\\\"\"\n+\" style=\\\"width:100%;height:100%;z-index:-1;left:0;top:0;position:absolute;\\\"\"\n+\" onload=\\\"this.contentWindow.document.body.style.backgroundColor=\"\n+\" this.parentNode.currentStyle.backgroundColor!='transparent'?\"\n+\" this.parentNode.currentStyle.backgroundColor:this.parentNode.firstChild.currentStyle.backgroundColor;\\\"></iframe>\"));}\nonselectstart=function(event){return false;}\noncontextmenu=function(event){return false;}\nonmouseout=function(event){event=event||window.event;var toElement=event.toElement;if(HTML.contains(this,toElement))return;thisObj.fireEvent(\"_onMouseLeave\");}\nonclick=function(event){event=event||window.event;event.cancelBubble=true;}}}\nprototype._load=function(item){if(!this._htmlElement)this._toHtmlElement();if(item==null){if(this._loaded)return;for(var i=0;i<this._items.length;i++){item=this._items[i];item._toHtmlElement();item.refresh();}\nthis._loaded=true;}else{item._toHtmlElement();}}\nprototype._getItemsToActualShow=function(){var flagLastType=-1;var items=[];for(var i=0,iLen=this._items.length;i<iLen;i++){var item=this._items[i];if(item.getIsHidden())continue;if(item.getTitle()!=\"-\"){flagLastType=0;}else if(i>0&&i<(iLen-1)&&flagLastType==0){flagLastType=1;}else{continue;}\nitems[items.length]=item;}\nif(flagLastType==1)items.pop();return items;}\nprototype._getMinWidth=function(aItems){var width=0;for(var i=0;i<aItems.length;i++){var sTitle=Object(aItems[i].getTitle());var length=sTitle.getAsciiCount()+sTitle.getNonAsciiCount()*2;if(length>width)width=length;}\nwidth=3+14+2+width*6+2+12+3;return width;}\nprototype._getMinHeight=function(aItems){var height=6;for(var i=0;i<aItems.length;i++){if(aItems[i].getTitle()==\"-\")height+=6;else height+=18;}\nreturn height;}\naddEventListener(false,false,\"onBeforeShow\",function(){this.getParentApp().fireEvent(\"_onMenuBeforeShow\",this);});addEventListener(false,false,\"onShow\",function(){this.getParentApp().fireEvent(\"_onMenuShowed\",this);});addEventListener(false,false,\"onHide\",function(){this.getParentApp().fireEvent(\"_onMenuHid\",this);});addEventListener(false,false,\"onMouseLeave\",function(){if(this.getParentApp().getIsHideOnMouseLeave()){this.getParentApp().hide();}});addEventListener(false,false,\"onDoAction\",function(oItem){this._lastDoneItem=oItem;this._parentApp.fireEvent(\"_onDoAction\",this);});}\n_$class.Item=function(parentMenu,sTitle,vData,fnAction){this._id=\"\";this._unid=\"\";this._title=\"\";this._action=new Function();this._enabled=true;this._isHidden=false;this._parentMenu=null;this._parentApp=null;this._subMenu=null;this._data;this._htmlElement=null;this._Item(parentMenu,sTitle,vData,fnAction);}\nwith(_$class.Item){$name=\"Item\";$extends(Object);prototype._Item=function(parentMenu,sTitle,vData,fnAction){this._parentMenu=parentMenu;this._parentApp=this._parentMenu.getParentApp();this._unid=\"I\"+(++this._parentApp.__usedIdCount);this._title=sTitle;this._data=vData;if(typeof(fnAction)==\"function\"){this._action=fnAction;}}\nprototype.getId=function(){return this._id||this._unid;}\nprototype.setId=function(value){this._id=value;}\nprototype.getLeft=function(){return this.getParentMenu().getLeft()+3;}\nprototype.getTop=function(){var retValue=this.getParentMenu().getTop()+3;for(var i=0,index=this.getIndex();i<index;i++){retValue+=this.getParentMenu().getItem(i).getHeight();}\nreturn retValue;}\nprototype.getWidth=function(){return this._htmlElement.clientWidth;}\nprototype.getHeight=function(){return this._htmlElement.clientHeight;}\nprototype.getTitle=function(){return this._title;}\nprototype.getEnabled=function(){return this._enabled;}\nprototype.setEnabled=function(value){this._enabled=value;}\nprototype.getIsHidden=function(){return this._isHidden;}\nprototype.setIsHidden=function(value){this._isHidden=value;}\nprototype.getParent=function(){if(!this._parentMenu)return(null);return(this._parentMenu.getOwner());}\nprototype.getParentMenu=function(){return this._parentMenu;}\nprototype.getParentApp=function(){return this._parentApp;}\nprototype.getIndex=function(){for(var i=0,length=this.getParentMenu().getLength();i<length;i++){var item=this.getParentMenu().getItem(i);if(this==item)return i;}}\nprototype.getPosition=function(){return(this.getIndex()+1+\"\");}\nprototype.getHasChildren=function(){if(this._subMenu==null)return false;if(this._subMenu.getLength()==0)return false;return true;}\nprototype.getData=function(){return this._data;}\nprototype.setData=function(value){this._data=value;}\nprototype.getNextSiblingItem=function(){return this.getParentMenu().getNextItem(this);}\nprototype.getPrevSiblingItem=function(){return this.getParentMenu().getPrevItem(this);}\nprototype.refresh=function(){if(!this._htmlElement)return;this._htmlElement.style.color=this._enabled?\"\":\"gray\";if(this.getParentMenu().getUseIcon()){this._htmlElement.all['icon'].style.width=\"16px\";}}\nprototype.activate=function(){this._htmlElement.fireEvent(\"_onActivate\");}\nprototype._toHtmlElement=function(){if(this._htmlElement)return;if(this._title!=\"-\"){this._toHtmlElementForStd();}else{this._toHtmlElementForSep();}}\nprototype._toHtmlElementForStd=function(){var thisObj=this;if(this._isHidden)return;with(this._htmlElement=this.getParentMenu()._htmlContainer.appendChild(document.createElement(\"div\"))){className=\"PopupMenuItem\";setAttribute(\"class\",\"PopupMenuItem\");with(appendChild(document.createElement(\"span\"))){id=\"icon\";innerHTML=this.getParentApp().getClass()._icons[\"blank\"];}\nwith(appendChild(document.createElement(\"span\"))){id=\"title\";innerHTML=\"<span>\"+this._title+\"</span>\";}\nwith(appendChild(document.createElement(\"span\"))){id=\"sub\";innerHTML=this.getParentApp().getClass()._icons[\"blank\"];}\nif(Global.Browser.Platform.ios){ontouchmove=function(event){thisObj.__isMoving=true;}\nontouchend=function(){if(!thisObj.__isMoving){this.onclick();}\nthisObj.__isMoving=false;}}else{onmouseover=function(event){event=event||window.event;try{if(document.selection){if(document.selection.empty){document.selection.empty();}else{document.selection=null;}}else if(window.getSelection){window.getSelection().removeAllRanges();}}catch(e){}\nthisObj.fireEvent(\"_onActivate\",event);}\nonmouseout=function(event){event=event||window.event;thisObj.fireEvent(\"_onDeactivate\",event);}}\nonclick=function(event){event=event||window.event;thisObj.fireEvent(\"_onDoAction\");}\nondblclick=function(){return false;}\nonselectstart=function(){return false;}}}\nprototype._toHtmlElementForSep=function(){with(this._htmlElement=this.getParentMenu()._htmlContainer.appendChild(document.createElement(\"div\"))){className=\"PopupMenuSepLine\";setAttribute(\"class\",\"PopupMenuSepLine\");}}\nprototype._onActivate=function(oEvent){with(this._htmlElement){className=\"PopupMenuItem ActivePopupMenuItem\";setAttribute(\"class\",\"PopupMenuItem ActivePopupMenuItem\");}\nthis.getParentMenu()._activeItem=this;}\nprototype._onDeactivate=function(oEvent){with(this._htmlElement){className=\"PopupMenuItem\";setAttribute(\"class\",\"PopupMenuItem\");}\nthis.getParentMenu()._activeItem=null;}\nprototype._onDoAction=function(oEvent){if(!this._enabled)return;if(this._title==\"\"||this._title==\"-\")return;this.getParentApp()._mainMenu.hide();this._action(this.getParentApp().getOwner());this._parentMenu.fireEvent(\"_onDoAction\",this);}}",
"js.ui.view.SimpleView" : "$package(\"js.ui.view\");js.ui.view.SimpleView=function(id,oTmpl,oPara,fnGetData){this._id=\"\";this._name=\"\";this._title=\"\";this._size=20;this._columns=[];this._entries=[];this._data=null;this._count=0;this._allCount=0;this._pagesCount=1;this._currentPage=1;this._currentCategory=\"\";this._currentSortName=\"\";this._currentSortSeq=-1;this._defaultSortSeq=-1;this._isSearching=false;this._searchKey=\"\";this._searchOptions={};this._defaultSearchOptions={};this._template=null;this._status=0;this._parent=null;this._target=null;this._startPos=null;this._endPos=null;this._interface={\"getPageData\":null}\nthis._SimpleView(id,oTmpl,oPara,fnGetData);}\nvar _$class=js.ui.view.SimpleView;with(_$class){$name=\"SimpleView\";$extends(\"Object\");prototype._SimpleView=function(id,oTmpl,oPara,fnGetData){oPara=oPara||{};this._id=id;this._template=oTmpl;this._title=oPara.title||\"\";this._size=oPara.size||20;this._columns=oPara.columns||[];this._currentCategory=oPara.category||\"\";this._currentSortName=oPara.sortName||\"\";this._currentSortSeq=this._defaultSortSeq=!oPara.sortName?-1:(oPara.sortSeq||0);this._defaultSearchOptions.size=Math.min(oPara.search&&oPara.search.size||this._size,100);this._defaultSearchOptions.max=Math.min(oPara.search&&oPara.search.max||100,1000);this._defaultSearchOptions.scope=oPara.search&&oPara.search.scope||\"\";this._target=this._parent=oPara.target;this._data=oPara.data;this._interface[\"getPageData\"]=fnGetData;this._load();this._status=1;if(oPara.pageNum)this.goPage(oPara.pageNum);else if(oPara.pageNum==undefined)this.goFirstPage();}\nprototype.getId=function(){return this._id;}\nprototype.getSize=function(){return this._size;}\nprototype.getCount=function(){return this._count;}\nprototype.getAllCount=function(){return this._allCount;}\nprototype.getPagesCount=function(){return this._pagesCount;}\nprototype.getCurrentPage=function(){return this._currentPage;}\nprototype.getCurrentCategory=function(){return this._currentCategory;}\nprototype.getCurrentSortName=function(){return this._currentSortName;}\nprototype.getCurrentSortSeq=function(){return this._currentSortSeq;}\nprototype.getIsSearching=function(){return this._isSearching;}\nprototype.getSearchKey=function(){return this._searchKey;}\nprototype.getSearchOptions=function(){return this._searchOptions;}\nprototype.getData=function(){return this._data;}\nprototype.setData=function(data){this._data=data;}\nprototype.getTemplate=function(){return this._template;}\nprototype.locateTo=function(sCategory){this._currentCategory=sCategory;this.fireEvent(\"_onCategoryChanged\",sCategory);this._load();this.goFirstPage();}\nprototype.sortBy=function(sSortName,iSortSeq){if(this._currentSortSeq==-1){this._currentSortSeq=iSortSeq||0;this._currentSortName=sSortName;}else if(iSortSeq!=undefined){this._currentSortSeq=iSortSeq;this._currentSortName=sSortName;}else if(this._currentSortName!=sSortName){this._currentSortSeq=0;this._currentSortName=sSortName;}else if(this._defaultSortSeq!=-1){this._currentSortSeq=(this._currentSortSeq+1)%2;}else if(this._currentSortSeq==1){this._currentSortSeq=-1;this._currentSortName=\"\";}else{this._currentSortSeq=(this._currentSortSeq+1)%2;}\nthis.fireEvent(\"_onSortStateChanged\");this.goPage(this._currentPage);}\nprototype.goPage=function(pageIndex){if(!pageIndex.isWithin(1,this._pagesCount))return;var startItem=(pageIndex-1)*this._size+1;try{var data=this._interface.getPageData.call(this,this._currentCategory\n,startItem,this._size,this._currentSortName,this._currentSortSeq);}catch(e){alert(\"Loaded new page fail, please contact your system administrator! \");var data=[0,[]];}\nthis._goPage(pageIndex,data[1]||[]);}\nprototype._goPage=function(pageIndex,data){this._entries=data||[];this._currentPage=pageIndex;this._loadPage();this.fireEvent(\"_onPageChanged\",pageIndex);}\nprototype._loadPage=function(){var code=this._template.parse({view:{id:this._id,title:this._title,columns:this._columns,entries:this._entries,data:this._data,size:this._size,allCount:this._allCount,pagesCount:this._pagesCount,currentPage:this._currentPage,currentCategory:this._currentCategory,currentSortName:this._currentSortName,currentSortSeq:this._currentSortSeq,isSearching:this._isSearching}});if(this._target){this._target.innerHTML=code;}else if(this._status==0){var script=Array.getLast(document.getElementsByTagName(\"SCRIPT\"));this._parent=script.parentNode;this._startPos=document.createElement(\"div\");this._startPos.style.display=\"none\";this._startPos.title=\"widgets-simpleview-start\";this._endPos=document.createElement(\"div\");this._endPos.style.display=\"none\";this._endPos.title=\"widgets-simpleview-end\";script.insertAdjacentElement(\"beforeBegin\",this._startPos);script.insertAdjacentHTML(\"beforeBegin\",code);script.insertAdjacentElement(\"beforeBegin\",this._endPos);}else if(this._endPos){for(var i=3,node;i>=0;i--){node=this._endPos.previousSibling;if(node==this._startPos)break;this._parent.removeChild(node);}\nthis._endPos.insertAdjacentHTML(\"beforeBegin\",code);}}\nprototype.goFirstPage=function(){this.goPage(1);}\nprototype.goPrevPage=function(){if(this._currentPage-1<1)return(false);this.goPage(this._currentPage-1);}\nprototype.goNextPage=function(){if(this._currentPage+1>this._pagesCount)return(false);this.goPage(this._currentPage+1);}\nprototype.goLastPage=function(){this.goPage(this._pagesCount);}\nprototype._load=function(){this._isSearching=false;this._allCount=this._interface.getPageData.call(this,this._currentCategory,1,0,this._currentSortName,this._currentSortSeq)[0];this._pagesCount=this._allCount?Math.ceil(this._allCount/this._size):1;this.fireEvent(\"_onLoaded\");}\nprototype.refresh=function(){this._load();this.goFirstPage();}\nprototype.reload=function(pageNum){this._load();this.goPage(Math.min(this._pagesCount,pageNum||this._currentPage));}\nprototype.search=function(key,options){this._searchKey=key;this._isSearching=!!key;if(!key){this.reload(0);}else{var options1={size:options&&options.size||this._defaultSearchOptions.size,max:options&&options.max||this._defaultSearchOptions.max,scope:options&&options.scope||this._defaultSearchOptions.scope}\nthis._searchOptions=options1;try{var data=this._interface.getPageData.call(this,this._currentCategory\n,1,options1.size,this._currentSortName,this._currentSortSeq);}catch(e){data=[0,[]];}\nthis._allCount=data[0];this._pagesCount=this._allCount?Math.ceil(this._allCount/this._size):1;this.fireEvent(\"_onLoaded\");this.fireEvent(\"_onSearchFinished\");this._goPage(1,data[1]);}}\nprototype._onLoaded=function(){this.fireEvent(\"onLoaded\");}\nprototype._onPageChanged=function(iPageNum){this.fireEvent(\"onPageChanged\",iPageNum);}\nprototype._onCategoryChanged=function(sCategory){this.fireEvent(\"onCategoryChanged\",sCategory);}\nprototype._onSortStateChanged=function(){this.fireEvent(\"onSortStateChanged\",[this._currentSortName,this._currentSortSeq]);}\nprototype._onSearchFinished=function(){this.fireEvent(\"onSearchFinished\",this._searchKey);}}"
}
}

}
});
